# 1. Scatterplot
plot(x$`Реальна температура`, x$Вологість,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
abline(lm(x$Вологість ~ x$`Реальна температура`) , col ='red' , lwd = 2)
cat("\014")
#install.packages('corrplot')
#install.packages("GGally")
library(corrplot)
library(GGally)
setwd("D:/Business/Study/Univ/3_course/1_semester/Data science/Lab_3/")
weaterHistory = read.csv(file = 'weatherHistory.csv', header = TRUE)
weaterHistory = weaterHistory[-c(10)]
weaterHistory = weaterHistory[-c(1:80000), ]
x = weaterHistory[ , c(4 : 9)]
x = x[-c(5)]
names(x)[1] = 'Реальна температура'
names(x)[2] = 'Уявна температура'
names(x)[3] = 'Вологість'
names(x)[4] = 'Швидкість вітру'
names(x)[5] = 'Видимість'
my_cols <- c("#00AFBB", "#E7B800", "#FC4E07")
# 1. Scatterplot
plot(x$`Реальна температура`, x$Вологість,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
abline(lm(x$Вологість ~ x$`Реальна температура`) , col ='red' , lwd = 2)
2^2
sum(x$Вологість - mean(x$Вологість))
sum((x$Вологість - mean(x$Вологість) * (x$`Реальна температура` - mean(x$`Реальна температура`))
sum((x$Вологість - mean(x$Вологість)) * (x$`Реальна температура` - mean(x$`Реальна температура`))
cat("\014")
#install.packages('corrplot')
#install.packages("GGally")
library(corrplot)
library(GGally)
setwd("D:/Business/Study/Univ/3_course/1_semester/Data science/Lab_3/")
weaterHistory = read.csv(file = 'weatherHistory.csv', header = TRUE)
weaterHistory = weaterHistory[-c(10)]
weaterHistory = weaterHistory[-c(1:80000), ]
data = weaterHistory[ , c(4 : 9)]
data = data[-c(5)]
names(data)[1] = 'Реальна температура'
names(data)[2] = 'Уявна температура'
names(data)[3] = 'Вологість'
names(data)[4] = 'Швидкість вітру'
names(data)[5] = 'Видимість'
rm(x)
rm(my_col)
rm(my_cols)
x = data$`Реальна температура`
y = data$Вологість
# 1. Scatterplot
plot(x, y,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
abline(lm(y ~ x) , col ='red' , lwd = 2)
sum(x - mean(x))
sum(y - mean(y))
sum((y - mean(y))
sum((y - mean(y)))
sum((x - mean(x)))
sum((x - mean(x)) * (y - mean(y)))
sum((x - mean(x)) * (y - mean(y))) / sum(x - mean(x))^2
sum((x - mean(x)) * (y - mean(y))) / (sum(x - mean(x))^2)
slope = sum((x - mean(x)) * (y - mean(y))) / (sum(x - mean(x))^2)
intercept = mean(y)- slope * mean(x)
abline(a = slope, b = intercept, lty = 2, lwd = 5, col = 'green')
abline(a = slope, b = intercept, lwd = 5, col = 'green')
abline(a = slope, b = intercept, lwd = 5, col = 'red')
abline(a = slope, b = intercept, lwd = 2, col = 'red')
abline(a = slope, b = intercept, lwd = 2, col = 'red')
# 1. Scatterplot
plot(x, y,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
abline(lm(y ~ x) , col ='red' , lwd = 2)
slope = sum((x - mean(x)) * (y - mean(y))) / (sum(x - mean(x))^2)
intercept = mean(y)- slope * mean(x)
abline(a = slope, b = intercept, lwd = 2, col = 'red')
slope = sum((x - mean(x)) * (y - mean(y))) / (sum(x - mean(x))^2)
slope
intercept
abline(slope, b = intercept, lwd = 2, col = 'red')
abline(slope, intercept, lwd = 2, col = 'red')
abline(intercept, lwd = 2, col = 'red')
abline(intercept, slope , lwd = 2, col = 'red')
slope
intercept
plot(x, y,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
abline(intercept, slope , lwd = 2, col = 'red')
abline(b = intercept, slope , lwd = 2, col = 'red')
abline(b = intercept, a = slope , lwd = 2, col = 'red')
abline(b = slope, a =  intercept, lwd = 2, col = 'red')
abline(b = slope, a = intercept, lwd = 2, col = 'red')
plot(x, y,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
abline(b = slope, a = intercept, lwd = 2, col = 'red')
abline(lm(y ~ x) , col ='red' , lwd = 2)
slope = cov(x , y) / var(x)
intercept = mean(y)- slope * mean(x)
abline(b = slope, a = intercept, lwd = 2, col = 'red')
plot(x, y,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
abline(b = slope, a = intercept, lwd = 2, col = 'red')
abline(b = slope, a = intercept, lwd = 2, col = 'green')
abline(lm(y ~ x) , col ='red' , lwd = 2)
abline(b = slope, a = intercept, lwd = 2, col = 'green')
slope =  sum((x - mean(x)) * (y - mean(y))) / sum((x-mean(x))^2)
intercept = mean(y)- slope * mean(x)
abline(b = slope, a = intercept, lwd = 2, col = 'red')
regressionModel = lm(y ~ x)
regressionModel
summary(regressionModel)
# 1. Scatterplot
plot(x, y,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
# 2. Regression model
regressionModel = lm(y ~ x)
summary(regressionModel)
slope =  sum((x - mean(x)) * (y - mean(y))) / sum((x-mean(x))^2)
intercept = mean(y)- slope * mean(x)
# 3. Regression line
abline(b = slope, a = intercept, lwd = 2, col = 'red')
#4.
# 1. Scatterplot
plot(x, y,
main="Діаграма розсіювання",
xlab="Реальна температура",
ylab="Вологість",
col = 'lightgreen',
pch = 20,
cex = 1)
# 2. Regression model
regressionModel = lm(y ~ x)
summary(regressionModel)
slope =  sum((x - mean(x)) * (y - mean(y))) / sum((x-mean(x))^2)
intercept = mean(y)- slope * mean(x)
# 3. Regression line
abline(b = slope, a = intercept, lwd = 2, col = 'red')
#4.
